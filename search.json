[{"path":"https://changsubiostats.github.io/scMultiMap/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 scMultiMap authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://changsubiostats.github.io/scMultiMap/articles/scMultiMap.html","id":"toy-example","dir":"Articles","previous_headings":"","what":"1. Toy example","title":"scMultiMap","text":"illustrate basic functionality scMultiMap, use toy Seurat object small_obj data frame candidate peak-gene pairs small_pairs_df contained R package run scMultiMap: example data, run scMultiMap: , scMultiMap takes Seurat object two modalities: RNA peak, tests associations 250 peak-gene pairs. assume Seurat object contains cells specific cell type interest, inferred associations cell-type-specific.","code":"# a Seurat object small_obj #> An object of class Seurat  #> 350 features across 100 samples within 2 assays  #> Active assay: RNA (100 features, 0 variable features) #>  1 layer present: counts #>  1 other assay present: peak  # candidate peak-gene pairs head(small_pairs_df) #>     gene                    peak #> 1 MALAT1 chr11-65013281-65014841 #> 2 MALAT1 chr11-65026934-65027962 #> 3 MALAT1 chr11-65040583-65041780 #> 4 MALAT1 chr11-65083457-65084665 #> 5 MALAT1 chr11-65095679-65096871 #> 6 MALAT1 chr11-65110172-65110785 dim(small_pairs_df) #> [1] 250   2 res <- scMultiMap(small_obj, small_pairs_df) # < 0.1 seconds #> [1] \"Start step 1: IRLS\" #> [1] \"Start IRLS for RNA\" #> [1] \"Start IRLS for peak\" #> [1] \"Start step 2: WLS\" #> [1] \"There are 10 unique genes in the peak-gene pairs.\" head(res) #>     gene                    peak       pval  test_stat         covar      padj #> 1 MALAT1 chr11-65013281-65014841 0.15215553  1.4319591  3.100282e-05 0.8273097 #> 2 MALAT1 chr11-65026934-65027962 0.79384145  0.2613256  5.204042e-06 0.9753992 #> 3 MALAT1 chr11-65040583-65041780 0.68116942  0.4108679  8.623731e-06 0.9472305 #> 4 MALAT1 chr11-65083457-65084665 0.03236884  2.1398259  4.879823e-05 0.7196890 #> 5 MALAT1 chr11-65095679-65096871 0.02264609 -2.2793530 -4.308216e-05 0.7196890 #> 6 MALAT1 chr11-65110172-65110785 0.88810490 -0.1407026 -1.919029e-06 0.9881934 #>           cor #> 1  0.00000000 #> 2  0.10216095 #> 3  0.29533510 #> 4  0.62091902 #> 5 -0.57664094 #> 6 -0.08605519 dim(res) #> [1] 250   7"},{"path":"https://changsubiostats.github.io/scMultiMap/articles/scMultiMap.html","id":"pbmc-example-from-10x-multiome-data","dir":"Articles","previous_headings":"","what":"2. PBMC example from 10x multiome data","title":"scMultiMap","text":"Next, use single cell multiome data (paired scRNA-seq scATAC-seq) 10x. data processed_seurat_obj_PBMC_10k.rds can generated following two Signac tutorials: Joint RNA ATAC analysis: 10x multiomic Calling peaks. first tutorial annotating PBMC cell types, second tutorial calling peaks cell type identify many cell-type-specific peaks possible. Note: note scMultiMap designed model fragment counts, appropriate count based modeling can yield improved performance downstream analysis compared read counts. See Miao Kim, 2024 Martens et al., 2024 discussions. plan use scMultiMap, please make sure scATAC-seq data fragment counts instead read counts. One recommended way use MACS2 call peaks generates fragment counts, shown Calling peaks. read counts, fragment counts can estimated following Martens et al., 2024. Back case study. load 10x multiome data PBMC R session: pbmc Seurat object ‘RNA’ assay gene expression data ‘peak’ assay chromatin accessibility data. example, focus CD14 monocytes: 3,146 cells cell type. choose study top 2,0002{,}000 highly expressed genes top 20,00020{,}000 highly accessible peaks CD14 Monocytes, use cis-region width 1Mb define candidate peak-gene pairs. , load 30,635 candidate peak-gene pairs generated based criterion . peak_gene_pairs dataframe includes 30,635 rows pairs two columns gene peak names, respectively. Generally, pairs formed provided users. Nect, run scMultiMap identify significantly associated peak-gene pairs Running scMultiMap 3,146 cells 30,635 peak-gene pairs take ~1 minute. res dataframe association statistics p-values 30,635 peak-gene pairs. vignettes package currently active development. examples coming soon!","code":"pbmc <- readRDS('processed_seurat_obj_PBMC_10k.rds') pbmc_cd14 <- subset(pbmc, predicted.id == 'CD14 Mono') pairs_df <- get_top_peak_gene_pairs(pbmc_cd14,                                      gene_top=2000, peak_top=20000,                                      distance = 5e+5,                                     gene_assay = 'RNA', peak_assay = 'peak') start <- Sys.time() res <- scMultiMap(pbmc_cd14, pairs_df,                    gene_assay = 'RNA',                   peak_assay = 'peak') end <- Sys.time()  end - start"},{"path":"https://changsubiostats.github.io/scMultiMap/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Chang Su. Author, maintainer.","code":""},{"path":"https://changsubiostats.github.io/scMultiMap/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Su C (2024). scMultiMap: Cell-type-specific mapping enhancer target genes single-cell multimodal data scMultiMap. R package version 0.9.1, https://changsubiostats.github.io/scMultiMap/.","code":"@Manual{,   title = {scMultiMap: Cell-type-specific mapping of enhancer and target genes from single-cell multimodal data with scMultiMap},   author = {Chang Su},   year = {2024},   note = {R package version 0.9.1},   url = {https://changsubiostats.github.io/scMultiMap/}, }"},{"path":"https://changsubiostats.github.io/scMultiMap/index.html","id":"scmultimap","dir":"","previous_headings":"","what":"Cell-type-specific mapping of enhancer and target genes from single-cell multimodal data with scMultiMap","title":"Cell-type-specific mapping of enhancer and target genes from single-cell multimodal data with scMultiMap","text":"scMultiMap R package inferring cell-type-specific peak-gene association single-cell multimodal data. provides implementation statistical method scMultiMap proposed manuscript: https://www.biorxiv.org/content/10.1101/2024.09.24.614814v1.","code":""},{"path":"https://changsubiostats.github.io/scMultiMap/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Cell-type-specific mapping of enhancer and target genes from single-cell multimodal data with scMultiMap","text":"scMultiMap available GitHub. can install using","code":"## Load devtools for installing R packages from Github library(devtools) ## Install CS-CORE from Github install_github(\"ChangSuBiostats/scMultiMap\")"},{"path":"https://changsubiostats.github.io/scMultiMap/index.html","id":"vignettes","dir":"","previous_headings":"","what":"Vignettes","title":"Cell-type-specific mapping of enhancer and target genes from single-cell multimodal data with scMultiMap","text":"vignette shows basic example using scMultiMap inferring peak-gene associations cell types using 10x multiome data PBMC. vignettes package currently active development. examples coming soon!","code":""},{"path":"https://changsubiostats.github.io/scMultiMap/index.html","id":"contact-us","dir":"","previous_headings":"","what":"Contact us","title":"Cell-type-specific mapping of enhancer and target genes from single-cell multimodal data with scMultiMap","text":"Chang Su, chang.su@emory.edu","code":""},{"path":"https://changsubiostats.github.io/scMultiMap/index.html","id":"reference-and-news","dir":"","previous_headings":"","what":"Reference and news","title":"Cell-type-specific mapping of enhancer and target genes from single-cell multimodal data with scMultiMap","text":"Cell-type-specific mapping enhancer target genes single-cell multimodal data. Chang Su, Dongsoo Lee, Peng Jin Jingfei Zhang. 2024. https://www.biorxiv.org/content/10.1101/2024.09.24.614814v1","code":""},{"path":"https://changsubiostats.github.io/scMultiMap/reference/example_pair.html","id":null,"dir":"Reference","previous_headings":"","what":"A simulated independent peak-gene pair — example_pair","title":"A simulated independent peak-gene pair — example_pair","text":"data set created illustrative purposes used test scMultiMap_IRLS() scMultiMap_WLS(). source code generating data set data-raw/ Github.","code":""},{"path":"https://changsubiostats.github.io/scMultiMap/reference/example_pair.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A simulated independent peak-gene pair — example_pair","text":"","code":"example_pair"},{"path":[]},{"path":"https://changsubiostats.github.io/scMultiMap/reference/example_pair.html","id":"example-pair","dir":"Reference","previous_headings":"","what":"example_pair","title":"A simulated independent peak-gene pair — example_pair","text":"Two lists (one named 'gene' named 'peak'), 2 elements: counts length 2000 vector gene/peak counts seq_depths length 2000 vector sequencing depths scRNA-seq/scATAC-seq","code":""},{"path":"https://changsubiostats.github.io/scMultiMap/reference/example_pair_bsample.html","id":null,"dir":"Reference","previous_headings":"","what":"A simulated perfectly correlated peak-gene pair with multiple biological samples present — example_pair_bsample","title":"A simulated perfectly correlated peak-gene pair with multiple biological samples present — example_pair_bsample","text":"data set created illustrative purposes used test scMultiMap_IRLS() scMultiMap_WLS(). source code generating data set data-raw/ Github.","code":""},{"path":"https://changsubiostats.github.io/scMultiMap/reference/example_pair_bsample.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A simulated perfectly correlated peak-gene pair with multiple biological samples present — example_pair_bsample","text":"","code":"example_pair_bsample"},{"path":[]},{"path":"https://changsubiostats.github.io/scMultiMap/reference/example_pair_bsample.html","id":"example-pair-bsample","dir":"Reference","previous_headings":"","what":"example_pair_bsample","title":"A simulated perfectly correlated peak-gene pair with multiple biological samples present — example_pair_bsample","text":"Three lists: first two list named 'gene' 'peak' respectively, 2 elements: counts length 2000 vector gene/peak counts seq_depths length 2000 vector sequencing depths scRNA-seq/scATAC-seq , third list named 'bsample' hosts length n vector sample labels","code":""},{"path":"https://changsubiostats.github.io/scMultiMap/reference/get_top_peak_gene_pairs.html","id":null,"dir":"Reference","previous_headings":"","what":"get_top_peak_gene_pairs — get_top_peak_gene_pairs","title":"get_top_peak_gene_pairs — get_top_peak_gene_pairs","text":"peaks genes high abundance, construct candidate pairs peaks close proximity gene.","code":""},{"path":"https://changsubiostats.github.io/scMultiMap/reference/get_top_peak_gene_pairs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"get_top_peak_gene_pairs — get_top_peak_gene_pairs","text":"","code":"get_top_peak_gene_pairs(   obj,   gene_top = 2000,   peak_top = 20000,   distance = 5e+05,   gene_assay = \"RNA\",   peak_assay = \"peak\" )"},{"path":"https://changsubiostats.github.io/scMultiMap/reference/get_top_peak_gene_pairs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"get_top_peak_gene_pairs — get_top_peak_gene_pairs","text":"obj Seurat object single-cell multimodal data. gene_top Number top highly expressed genes. Default 2000. peak_top Number top highly accessible peaks. Default 20000. distance Distance threshold peaks considered possibly associated genes. Default 5e+05. gene_assay Name gene assay Seurat object. Default 'RNA'. peak_assay Name peak assay Seurat object. Default 'peak'.","code":""},{"path":"https://changsubiostats.github.io/scMultiMap/reference/get_top_peak_gene_pairs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"get_top_peak_gene_pairs — get_top_peak_gene_pairs","text":"data frame candidate peak-gene pairs. gene gene peak-gene pair peak peak peak-gene pair","code":""},{"path":"https://changsubiostats.github.io/scMultiMap/reference/scMultiMap.html","id":null,"dir":"Reference","previous_headings":"","what":"scMultiMap — scMultiMap","title":"scMultiMap — scMultiMap","text":"Run scMultiMap infer cell-type-specific peak-gene associations.","code":""},{"path":"https://changsubiostats.github.io/scMultiMap/reference/scMultiMap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"scMultiMap — scMultiMap","text":"","code":"scMultiMap(   obj,   pairs_df,   bsample = NULL,   gene_assay = \"RNA\",   peak_assay = \"peak\",   seq_depth_list = NULL,   irls = T,   verbose = F )"},{"path":"https://changsubiostats.github.io/scMultiMap/reference/scMultiMap.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"scMultiMap — scMultiMap","text":"Cell-type-specific mapping enhancer target genes single-cell multimodal data. Chang Su, Dongsoo Lee, Peng Jin, Jingfei Zhang; https://www.biorxiv.org/content/10.1101/2024.09.24.614814v1","code":""},{"path":"https://changsubiostats.github.io/scMultiMap/reference/scMultiMap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"scMultiMap — scMultiMap","text":"obj Seurat object single-cell multimodal data. pairs_df data frame peak-gene pairs evaluate. first column gene name, second column peak name. bsample Default NULL cells biological sample. multiple biological samples present, bsample either column name sample label Seurat object meta data, length n vector labels biological samples. gene_assay Name gene assay Seurat object. Default 'RNA'. peak_assay Name peak assay Seurat object. Default 'peak'. seq_depth_list list two length n vectors sequencing depths. NULL, calculated total number gene/peak counts cell two modalities, respectively. irls Whether run IRLS estimate mean variance parameters step 1. Default TRUE. verbose Whether print detailed messages. Default FALSE.","code":""},{"path":"https://changsubiostats.github.io/scMultiMap/reference/scMultiMap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"scMultiMap — scMultiMap","text":"data frame scMultiMap results five columns. gene gene peak-gene pair peak peak peak-gene pair pval p-value test_stat test statistics covar estimated covariance row corresponds one peak-gene pair's results scMultiMap. pval test_stat denote statistical significance peak-gene association, covar denote magnitude association. number rows equal number pairs pairs_df present Seurat object.","code":""},{"path":"https://changsubiostats.github.io/scMultiMap/reference/scMultiMap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"scMultiMap — scMultiMap","text":"","code":"# For illustrative purposes, we provide # a toy Seurat object `small_obj` and # a data frame of candidate peak-gene pairs `small_pairs_df` # in this R package. res <- scMultiMap(small_obj, small_pairs_df) #> Loading required package: SeuratObject #> Loading required package: sp #> ‘SeuratObject’ was built under R 4.4.0 but the current version is #> 4.4.1; it is recomended that you reinstall ‘SeuratObject’ as the ABI #> for R may have changed #>  #> Attaching package: ‘SeuratObject’ #> The following objects are masked from ‘package:base’: #>  #>     intersect, t #> [1] \"Start step 1: IRLS\" #> [1] \"Start IRLS for RNA\" #> [1] \"Start IRLS for peak\" #> [1] \"Start step 2: WLS\" #> [1] \"There are 10 unique genes in the peak-gene pairs.\" head(res,2) #>     gene                    peak      pval test_stat        covar      padj #> 1 MALAT1 chr11-65013281-65014841 0.1521555 1.4319591 3.100282e-05 0.8273097 #> 2 MALAT1 chr11-65026934-65027962 0.7938414 0.2613256 5.204042e-06 0.9753992 #>        cor #> 1 0.000000 #> 2 0.102161 #    gene                    peak      pval test_stat        covar # 1 MALAT1 chr11-65013281-65014841 0.1521555 1.4319591 3.100282e-05 # 2 MALAT1 chr11-65026934-65027962 0.7938414 0.2613256 5.204042e-06"},{"path":"https://changsubiostats.github.io/scMultiMap/reference/scMultiMap_IRLS.html","id":null,"dir":"Reference","previous_headings":"","what":"Iteratively reweighted least squares (IRLS) in scMultiMap — scMultiMap_IRLS","title":"Iteratively reweighted least squares (IRLS) in scMultiMap — scMultiMap_IRLS","text":"function implements 1st step scMultiMap: estimate mean variance peaks genes IRLS. output used input 2nd step, scMultiMap_WLS(), estimate infer association genes peaks.","code":""},{"path":"https://changsubiostats.github.io/scMultiMap/reference/scMultiMap_IRLS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Iteratively reweighted least squares (IRLS) in scMultiMap — scMultiMap_IRLS","text":"","code":"scMultiMap_IRLS(X, seq_depth, bsample = NULL, irls = T, verbose = F)"},{"path":"https://changsubiostats.github.io/scMultiMap/reference/scMultiMap_IRLS.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Iteratively reweighted least squares (IRLS) in scMultiMap — scMultiMap_IRLS","text":"Cell-type-specific mapping enhancer target genes single-cell multimodal data. Chang Su, Dongsoo Lee, Peng Jin, Jingfei Zhang; https://www.biorxiv.org/content/10.1101/2024.09.24.614814v1","code":""},{"path":"https://changsubiostats.github.io/scMultiMap/reference/scMultiMap_IRLS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Iteratively reweighted least squares (IRLS) in scMultiMap — scMultiMap_IRLS","text":"X n p count matrix, n denotes number cells p denotes number genes/peaks. can length p vector n=1. seq_depth length n vector sequencing depths bsample length n vector names biological sample cell . cells sample, set NULL (Default). irls Whether use IRLS. Default TRUE. FALSE, use ordinary least squares. verbose Whether print detailed messages. Default FALSE.","code":""},{"path":"https://changsubiostats.github.io/scMultiMap/reference/scMultiMap_IRLS.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Iteratively reweighted least squares (IRLS) in scMultiMap — scMultiMap_IRLS","text":"list two length p vectors: mu estimated mean sigma_sq estimated variance","code":""},{"path":"https://changsubiostats.github.io/scMultiMap/reference/scMultiMap_IRLS.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Iteratively reweighted least squares (IRLS) in scMultiMap — scMultiMap_IRLS","text":"","code":"# The following codes illustrate the use of `scMultiMap_IRLS` with toy datasets # `small_obj` provided in this R package. irls_list <- list() irls_list[['gene']] <- scMultiMap_IRLS(Matrix::t(small_obj[['RNA']]$counts),  Matrix::colSums(small_obj[['RNA']]$counts)) irls_list[['peak']] <- scMultiMap_IRLS(Matrix::t(small_obj[['peak']]$counts),  Matrix::colSums(small_obj[['peak']]$counts)) print(str(irls_list[['gene']])) # estimated mean and variance for genes #> List of 3 #>  $ mu      : Named num [1:100] 0.1273 0.0341 0.0241 0.0241 0.0216 ... #>   ..- attr(*, \"names\")= chr [1:100] \"MALAT1\" \"LYZ\" \"B2M\" \"ACTB\" ... #>  $ sigma_sq: Named num [1:100] 1.57e-03 2.05e-04 5.67e-05 7.81e-05 2.00e-04 ... #>   ..- attr(*, \"names\")= chr [1:100] \"MALAT1\" \"LYZ\" \"B2M\" \"ACTB\" ... #>  $ theta   : num 5.05 #> NULL print(str(irls_list[['peak']])) # estimated mean and variance for peaks #> List of 3 #>  $ mu      : Named num [1:250] 0.00559 0.00359 0.00423 0.00436 0.00282 ... #>   ..- attr(*, \"names\")= chr [1:250] \"chr11-65013281-65014841\" \"chr11-65026934-65027962\" \"chr11-65040583-65041780\" \"chr11-65083457-65084665\" ... #>  $ sigma_sq: Named num [1:250] -5.06e-06 1.65e-06 5.43e-07 3.94e-06 3.56e-06 ... #>   ..- attr(*, \"names\")= chr [1:250] \"chr11-65013281-65014841\" \"chr11-65026934-65027962\" \"chr11-65040583-65041780\" \"chr11-65083457-65084665\" ... #>  $ theta   : num 4.1 #> NULL"},{"path":"https://changsubiostats.github.io/scMultiMap/reference/scMultiMap_WLS.html","id":null,"dir":"Reference","previous_headings":"","what":"Weighted least squares (WLS) in scMultiMap — scMultiMap_WLS","title":"Weighted least squares (WLS) in scMultiMap — scMultiMap_WLS","text":"function implements 2nd step scMultiMap: estimate infer peak-gene association WLS. takes output 1st step, scMultiMap_IRLS input.","code":""},{"path":"https://changsubiostats.github.io/scMultiMap/reference/scMultiMap_WLS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Weighted least squares (WLS) in scMultiMap — scMultiMap_WLS","text":"","code":"scMultiMap_WLS(count_list, seq_depth_list, pairs_df, irls_list, verbose = F)"},{"path":"https://changsubiostats.github.io/scMultiMap/reference/scMultiMap_WLS.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Weighted least squares (WLS) in scMultiMap — scMultiMap_WLS","text":"Cell-type-specific mapping enhancer target genes single-cell multimodal data. Chang Su, Dongsoo Lee, Peng Jin, Jingfei Zhang; https://www.biorxiv.org/content/10.1101/2024.09.24.614814v1","code":""},{"path":"https://changsubiostats.github.io/scMultiMap/reference/scMultiMap_WLS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Weighted least squares (WLS) in scMultiMap — scMultiMap_WLS","text":"count_list list two p n count matrices. first element gene second peak. seq_depth_list list two length p vectors sequencing depths. first element scRNA-seq second scATAC-seq. pairs_df data frame candidate peak-gene pairs evaluate. first column gene name, second peak name. irls_list list two lists generated 1st step scMultiMap, .e. scMultiMap_IRLS. first list contains results genes, second peaks. verbose Whether print detailed messages. Default FALSE.","code":""},{"path":"https://changsubiostats.github.io/scMultiMap/reference/scMultiMap_WLS.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Weighted least squares (WLS) in scMultiMap — scMultiMap_WLS","text":"data.frame five columns gene gene peak-gene pair peak peak peak-gene pair pval p-value test_stat test statistics covar estimated covariance row corresponds one peak-gene pair's results scMultiMap. pval test_stat denote statistical significance peak-gene association, covar denote magnitude association. number rows equal number pairs pairs_df present Seurat object.","code":""},{"path":"https://changsubiostats.github.io/scMultiMap/reference/scMultiMap_WLS.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Weighted least squares (WLS) in scMultiMap — scMultiMap_WLS","text":"","code":"count_list <- list(gene = Matrix::t(small_obj[['RNA']]$counts),  peak = Matrix::t(small_obj[['peak']]$counts)) seq_depth_list <- list(gene = Matrix::colSums(small_obj[['RNA']]$counts),  peak = Matrix::colSums(small_obj[['peak']]$counts)) wls_res <- scMultiMap_WLS(count_list, seq_depth_list, small_pairs_df, small_irls_list) #> [1] \"There are 10 unique genes in the peak-gene pairs.\""},{"path":"https://changsubiostats.github.io/scMultiMap/reference/scMultiMap_WLS_by_gene.html","id":null,"dir":"Reference","previous_headings":"","what":"WLS utility function. — scMultiMap_WLS_by_gene","title":"WLS utility function. — scMultiMap_WLS_by_gene","text":"function performs WLS one gene peaks candidate pairs.","code":""},{"path":"https://changsubiostats.github.io/scMultiMap/reference/scMultiMap_WLS_by_gene.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"WLS utility function. — scMultiMap_WLS_by_gene","text":"","code":"scMultiMap_WLS_by_gene(   x_gene,   X_peak,   m_gene,   M_peak,   w_gene,   W_peak,   var_gene,   Var_peak,   gene_seq_depth,   peak_seq_depth )"},{"path":"https://changsubiostats.github.io/scMultiMap/reference/scMultiMap_WLS_by_gene.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"WLS utility function. — scMultiMap_WLS_by_gene","text":"Cell-type-specific mapping enhancer target genes single-cell multimodal data. Chang Su, Dongsoo Lee, Peng Jin, Jingfei Zhang;","code":""},{"path":"https://changsubiostats.github.io/scMultiMap/reference/scMultiMap_WLS_by_gene.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"WLS utility function. — scMultiMap_WLS_by_gene","text":"x_gene length n vector gene counts. n denotes number cells. X_peak n p peak count matrix. p denotes number peaks. m_gene length n vector gene counts' mean across cells. M_peak n p matrix peak counts' mean across cells peaks. w_gene length n vector used calculate regression weights. W_peak n p matrix used calculate regression weights. var_gene length n vector gene counts' variance across cells. Var_peak n p matrix peak counts' variance across cells peaks. gene_seq_depth length n vector sequencing depths RNA modality. peak_seq_depth length n vector sequencing depths ATAC/peak modality.","code":""},{"path":"https://changsubiostats.github.io/scMultiMap/reference/scMultiMap_WLS_by_gene.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"WLS utility function. — scMultiMap_WLS_by_gene","text":"data.frame p rows three columns pval p-value test_stat test statistics covar estimated covariance row correspond scMultiMap's WLS result one gene-peak pair.","code":""},{"path":"https://changsubiostats.github.io/scMultiMap/reference/small_irls_list.html","id":null,"dir":"Reference","previous_headings":"","what":"A toy example of estimated results from scMultiMap_IRLS() on small_obj. — small_irls_list","title":"A toy example of estimated results from scMultiMap_IRLS() on small_obj. — small_irls_list","text":"source code generating data set data-raw/ Github.","code":""},{"path":"https://changsubiostats.github.io/scMultiMap/reference/small_irls_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A toy example of estimated results from scMultiMap_IRLS() on small_obj. — small_irls_list","text":"","code":"small_irls_list"},{"path":[]},{"path":"https://changsubiostats.github.io/scMultiMap/reference/small_irls_list.html","id":"small-irls-list","dir":"Reference","previous_headings":"","what":"small_irls_list","title":"A toy example of estimated results from scMultiMap_IRLS() on small_obj. — small_irls_list","text":"list two lists generated 1st step scMultiMap gene scMultiMap_IRLS results genes peak scMultiMap_IRLS results peaks","code":""},{"path":"https://changsubiostats.github.io/scMultiMap/reference/small_obj.html","id":null,"dir":"Reference","previous_headings":"","what":"A small pedagogical Seurat object — small_obj","title":"A small pedagogical Seurat object — small_obj","text":"Seurat object created illustrative purposes used test scMultiMap(). source code generating data set data-raw/ Github.","code":""},{"path":"https://changsubiostats.github.io/scMultiMap/reference/small_obj.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A small pedagogical Seurat object — small_obj","text":"","code":"small_obj"},{"path":[]},{"path":"https://changsubiostats.github.io/scMultiMap/reference/small_obj.html","id":"small-obj","dir":"Reference","previous_headings":"","what":"small_obj","title":"A small pedagogical Seurat object — small_obj","text":"Seurat object 100 cells two assay RNA gene count matrix 100 genes 100 cells peak peak count matrix 250 genes 100 cells","code":""},{"path":"https://changsubiostats.github.io/scMultiMap/reference/small_pairs_df.html","id":null,"dir":"Reference","previous_headings":"","what":"A data frame of peak-gene pairs, to be used with small_obj — small_pairs_df","title":"A data frame of peak-gene pairs, to be used with small_obj — small_pairs_df","text":"data frame holds candidate peak-gene pairs inferred scMultiMap() small_obj. source code generating data set data-raw/ Github.","code":""},{"path":"https://changsubiostats.github.io/scMultiMap/reference/small_pairs_df.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A data frame of peak-gene pairs, to be used with small_obj — small_pairs_df","text":"","code":"small_pairs_df"},{"path":[]},{"path":"https://changsubiostats.github.io/scMultiMap/reference/small_pairs_df.html","id":"small-pairs-df","dir":"Reference","previous_headings":"","what":"small_pairs_df","title":"A data frame of peak-gene pairs, to be used with small_obj — small_pairs_df","text":"data frame 250 rows (peak-gene pairs) 2 columns gene gene name peak peak name","code":""}]
